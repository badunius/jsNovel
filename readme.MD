## jsNovel

### Цель
~~Пирожок~~ Движок на JS

### Условия
1. Никакой ноды, никакого вебпака, никаких зависимостей

### Хотелки
* Максимально простое наполнение контентом
* Максимальная гибкость (ведь каждый строчит так, как хочет)
* Возможность локализации текстовых ресурсов
* Desktop/Mobile, Portrait/Landscape из коробки

### Оговорки
* Если в вашем браузере что-то не работает — говно ваш браузер

## Тезисы
* При переходе к сцене создаётся её копия, в неё добавляется копия актуального контекста (`context`) и пустое поле для временного хранения значений полей ввода (`store`)
* Обработчик действия получает аргументом сцену, может читать контекст, может смотреть, что там навводил пользователь
* Обработчик действия должен вернуть объект, который может содержать до шести полей
1. `config` — объект для актуализации конфига через `Object.assign`
2. `context` — объект для актуализации контекста через `Object.assign`
3. `scene` — строка, содержащая имя сцены, к которой нужно перейти
4. `actions` — новый набор действий, на случай, если нужно обновить действия, не обновляя сцены (sub-menu)
5. `userpic` — TODO: описать формат для юзерпика. Хочется сделать его как минимум слоёным, но конкретики в голове пока никакой нет.
6. `stats` — объект для актуализации отображаемых статов игрока
* **NB:** возможно, придётся отвязать иконку от сцены и задавать её по аналогии с юзерпиком (их выводит один и тот же класс, энивэй)
* **NB:** для сохранения будет пробрасываться метод `saveTo(%slotID%)` или что-то типа того, чтобы `storekey` не засорял контекст.
* **TODO:** __Добавить отслеживание реальной смены сцены. То есть, чтоб можно было поймать момент, когда мы выводим её впервые, а когда показываем ту же самую.__
__Поясню: допустим у нас диалог и доступен инвентарь. Поскольку я веду диалог, отображается иконка собеседника. Если я залезу в инвентарь — я хочу, чтобы отобразился условный знак инвентаря вместо иконки собеседника. Но когда я вернусь из инвентаря, я хочу, чтобы иконка собеседника вернулась. Вот это всё нужно оформить в нормальные тезисы__
* **TODO:** Добавить TextBox возможность выводить не просто параграфы, а с классами.
Например, парсить по двоеточию. Тогда `p:emphasis:red` преобразуется в `<p class="emphasis red">`
* Поля обрабатываются в указанном порядке. То есть, сначала обновится контекст, потом произойдёт сохранение, потом вызовется новая сцена, потом будет обновлён список действий
* Поскольку нормальный браузер ~~бьёт по морде, а не по паспорту~~ смотрит на content-type, а не на расширение файла, вся графика считается png-файлами. То есть, это может быть JPEG, может быть GIF — плевать, переименовывай в png. Зато в шаблонах не нужно будет указывать раширение и можно будет запросто перейти от одного формата к другому изменив файл и не трогая код.